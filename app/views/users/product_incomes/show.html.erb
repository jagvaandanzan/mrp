<% content_for :stylesheets do -%>
  <%= stylesheet_link_tag "show" %>
<% end %>
<div class="content-wrapper">
  <%= render 'layouts/flash_message' %>
  <section class="content-header align-left padding-15">
    <h1> <%= t('activerecord.models.product_income') %> </h1>
  </section>

  <div class="action-buttons">
    <% if can? :update, ProductIncome %>
      <%= link_to t('controls.button.edit'), edit_users_product_income_path(@product_income), class: 'btn btn-info' %>
    <% end %>
    <%= link_to t('titles.back_to_list'), users_product_incomes_path(page: cookies[:page_number]), {class: "btn blck-btn"} %>
    <% if can? :destroy, ProductIncome %>
      <%= link_to t('controls.button.delete'), users_product_income_path(@product_income), method: :delete, data: {confirm: t('are_you_sure')}, class: 'btn btn-danger' %>
    <% end %>
  </div>
  <%= show_body do %>
    <div class="box">
      <div class="box-body">
        <div class="col-md-12">
          <div class="row">
            <div class="col-md-3 field_div">
              <div class="div_input">
                <b><%= t('activerecord.attributes.product_income.code') %>:</b> <%= @product_income.code %>
              </div>
            </div>
            <div class="col-md-3 field_div">
              <div class="div_input">
                <b><%= t('activerecord.attributes.product_income.income_date') %>
                  :</b> <%= @product_income.income_date.strftime('%F') %>
              </div>
            </div>
            <div class="col-md-3 field_div">
              <div class="div_input">
                <b><%= t('activerecord.attributes.product_income.logistic_id') %>
                  :</b> <%= @product_income.logistic.name %>
              </div>
            </div>
            <div class="col-md-3 field_div">
              <div class="div_input">
                <b><%= t('activerecord.attributes.product_income.cargo_price') %>
                  :</b> <%= @product_income.cargo_price %>
              </div>
            </div>
          </div>
        </div>

        <% if @product_income.product_income_items.present? %>
          <div class="col-md-12 group_div m-t-20">
            <b><%= t('activerecord.attributes.product_income.product_income_items') %></b>
            <table class="table table-bordered">
              <thead>
              <tr>
                <th class="va-mid"><%= t('activerecord.attributes.shipping_er_item.product_code') %></th>
                <th class="va-mid"><%= t('activerecord.attributes.shipping_er_item.product_name') %></th>
                <th class="va-mid"><%= t('activerecord.attributes.shipping_er_item.product_image') %></th>
                <th class="va-mid"><%= t('activerecord.attributes.shipping_er_item.product_feature') %></th>
                <th class="va-mid"><%= t('activerecord.attributes.product_income_item.order_number') %></th>
                <th class="va-mid"><%= t('activerecord.attributes.product_income_item.loaded') %></th>
                <th class="va-mid"><%= t('activerecord.attributes.product_income_item.quantity') %></th>
                <th class="va-mid"><%= t('activerecord.attributes.product_income_item.cargo') %></th>
                <th class="va-mid"><%= t('activerecord.attributes.product_income_item.shipping_cost') %></th>
                <th class="va-mid"><%= t('activerecord.attributes.product_income_item.qr_printed') %></th>
                <th class="va-mid"><%= t('activerecord.attributes.product_income_item.problematic') %></th>
                <th class="va-mid"><%= t('activerecord.attributes.product_income_item.shelf') %></th>
              </tr>
              </thead>
              <tbody>
              <% @product_income.product_income_items.each do |i| %>
                <% product = i.product
                   feature_item = i.feature_item %>
                <tr>
                  <td class="va-mid"><%= product.code %></td>
                  <td class="va-mid"><%= product.name %></td>
                  <td class="va-mid">
                    <% if feature_item.img.present? %>
                      <%= link_to feature_item.img.url, "data-lightbox": "roadtrip" do %>
                        <%= t('titles.view') %>
                      <% end %>
                    <% end %>
                  </td>
                  <td class="va-mid"><%= feature_item.name %></td>
                  <td class="va-mid"><%= i.supply_feature.quantity %></td>
                  <td class="va-mid"><%= i.shipping_ub_item.loaded %></td>
                  <td class="va-mid"><%= i.quantity %></td>
                  <td class="va-mid"><%= i.cargo %></td>
                  <td class="va-mid"><%= get_currency(i.shipping_cost, "ï¿¥", 0) %></td>
                  <td class="va-mid"><%= i.qr_printed %></td>
                  <td class="va-mid"><%= i.problematic %></td>
                  <td class="va-mid">
                    <% i.income_locations.each {|i_loc| %>
                      <% location = i_loc.location %>
                      <div>
                        <span>x<%= location.x %></span>
                        <span>y<%= location.y %></span>
                        <span>z<%= location.z %></span>:&nbsp;<%= i_loc.quantity %>
                      </div>
                    <% } %>
                  </td>
                </tr>
              <% end %>
              </tbody>
            </table>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
</div>